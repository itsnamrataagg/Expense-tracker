<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <h1 class="text-center mb-4">Admin Panel</h1>
    <button class="btn btn-secondary mb-3" onclick="logout()">Logout</button>

    <h2>All Users</h2>
    <button class="btn btn-primary mb-2" onclick="getUsers()">View Users</button>
    <pre id="users"></pre>

    <h2>All Expenses</h2>
    <button class="btn btn-primary mb-2" onclick="getExpenses()">View Expenses</button>
    <pre id="expenses"></pre>
</div>

<script>
const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));


// Ensure loggedInUser exists and role is ADMIN (case-insensitive)
if(!loggedInUser || !loggedInUser.role || loggedInUser.role.toUpperCase() !== "ADMIN"){ 
    alert("Access denied! Only admins."); 
    window.location.href="login.html"; 
}



function logout(){ localStorage.removeItem("loggedInUser"); window.location.href="login.html"; }

async function getUsers(){
    const res = await fetch('/admin/users');
    const users = await res.json();
    document.getElementById('users').textContent = JSON.stringify(users,null,2);
}

async function getExpenses(){
    const res = await fetch('/admin/expenses');
    const expenses = await res.json();
    document.getElementById('expenses').textContent = JSON.stringify(expenses,null,2);
}
</script>
</body>
</html>
